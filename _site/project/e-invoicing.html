<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <link rel="icon" type="image/x-icon" href="/assets/image/favicon/favicon.ico" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>E-Invoicing Application | Zzn021.github.io</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="E-Invoicing Application" />
<meta name="author" content="Zeneng Zhao" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction" />
<meta property="og:description" content="Introduction" />
<link rel="canonical" href="http://localhost:4000/project/e-invoicing" />
<meta property="og:url" content="http://localhost:4000/project/e-invoicing" />
<meta property="og:site_name" content="Zzn021.github.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-03-13T22:50:22+11:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="E-Invoicing Application" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zeneng Zhao"},"dateModified":"2023-03-13T22:50:22+11:00","datePublished":"2023-03-13T22:50:22+11:00","description":"Introduction","headline":"E-Invoicing Application","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/project/e-invoicing"},"url":"http://localhost:4000/project/e-invoicing"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Zzn021.github.io" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Zzn021.github.io</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/aboutme/">About Me</a><a class="page-link" href="/photography/">Photography</a><a class="page-link" href="/blog">Blogs</a><a class="page-link" href="/projects">Projects</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">E-Invoicing Application</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-03-13T22:50:22+11:00" itemprop="datePublished">Mar 13, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h3 id="introduction">Introduction</h3>

<p>This was my first UNSW software engineering work shop project, a SaaS e-invoicing app, includes features such as invoice creation, validation, rendering and sending.The project is deployed on AWS, it uses UBL-XML messaging over the PEPPOL network and aimed at meeting SME requirements in a standards-compliant way.</p>

<dl>
  <dt>E-Invoicing ?</dt>
  <dd>Australia is shifting from paper and emailed PDFs to structured, machine-readable invoices that move directly between accounting systems. NSW accelerated the change by mandating that all state agencies accept e-invoices for goods and services up to AUD 1 million from 2022. The switch, part of the broader Industry 4.0 push, delivers faster payments, fewer errors, and tighter fraud controls.</dd>
</dl>

<h3 id="team">Team</h3>

<p>Our four-person team adopted clear roles: Team Leader, Product Owner (myself), and Delivery Manager. As Product Owner, I shaped the product vision, prioritised the backlog, and kept the team focused on the highest-value features. We ran the project with an Agile cadence: weekly sprint meetings plus asynchronous check-ins, tracking work in Jira and storing documentation in Confluence.</p>

<h3 id="requirements-engineering">Requirements Engineering</h3>

<p>Before coding began, we carried out a full requirements-engineering phase: reviewing the A-NZ PEPPOL interoperability rules, mapping user stories with clear acceptance criteria, and documenting both functional and non-functional requirements.</p>

<p>We studied into the AU/NZ UBL implementation guides and PEPPOL specifications (<a href="https://github.com/A-NZ-PEPPOL/A-NZ-PEPPOL-BIS-3.0">PEPPOL specifiations</a>), turning requirements into concrete backlog items from day one.</p>

<h3 id="application-architecture">Application Architecture</h3>

<ul>
  <li>
    <h4 id="deployment-layer">Deployment Layer</h4>

    <p>The deployment layer is responsible for deploying the application to a cloud provider. The application is deployed on Amazonâ€™s Web Service (AWS) Elastic Beanstalk. It provides an environment that automatically handles the deployment, scaling, and load balancing of the application. It is a scalable, reliable, and cost-effective solution for deploying web applications.</p>
  </li>
  <li>
    <h4 id="interface-layer">Interface Layer</h4>

    <p>The interface layer is responsible for providing a user-friendly interface for users to interact with the application. The application uses a web-based user interface through HTML, CSS, and Javascript. The frontend framework used React, which provides reusable components and robust state management, connecting to the backend via RESTful APIs. The frontend is deployed on AWS Amplify.</p>
  </li>
  <li>
    <h4 id="service-layer">Service Layer</h4>

    <p>The service layer is responsible for providing the backend functionality of the application. We create a RESTful API using Flask, which is a lightweight and efficient Python web framework that provides necessary tools. The API will provide endpoints and routes for creating an invoice, here is a example of our creation API on <a href="https://app.swaggerhub.com/apis/raymond.guo122/InvoiceCreation/1.0.0#/default/post_invoice_creation">Swagger</a></p>
  </li>
</ul>

<h3 id="system-modelling">System Modelling</h3>

<p><img src="/assets/image/projects/e-invoice/system-modelling.png" alt="alt text" />
We modelled the application with UML sequence diagrams that trace the complete user journey, from sign-up and authentication through file upload, JSON/XML-to-UBL conversion, validation, and download. The diagram spans the user interface, user database, and two micro-service APIs. Mapping each call and <strong><em>break</em></strong> branch upfront helped clarify service boundaries, data transformations, and error handling, giving the team a shared blueprint before any code was written.</p>

<h3 id="develop">Develop</h3>

<h4 id="backend"><strong>Backend</strong></h4>

<p>The hardest challenge was the invoice-creation engine: we had to parse four input formats (<em>xml, csv, xls, json</em>) using different libraries, normalise them into one consistent XML tree, and then map that tree onto the PEPPOL-compliant UBL schema.</p>

<p>To guarantee UBL compliance, each raw input is first transformed into a single canonical JSON representation. From that JSON we generate a fresh XML document that exactly matches the PEPPOL UBL schema. Thus, we used thirdparty library for each format to help us for the normalisation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">csv</span>
<span class="kn">import</span> <span class="n">openpyxl</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">xmltodict</span>
</code></pre></div></div>

<p>CSV to json example:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">csv_to_json</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">csv_file</span><span class="p">:</span>
        <span class="n">csv_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="p">.</span><span class="nc">DictReader</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv_reader</span><span class="p">:</span>
            <span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">key</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)</span>
                <span class="n">current_dict</span> <span class="o">=</span> <span class="n">record</span>
                <span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">current_dict</span><span class="p">.</span><span class="nf">setdefault</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">current_dict</span> <span class="o">=</span> <span class="n">current_dict</span><span class="p">[</span><span class="n">part</span><span class="p">]</span>
                <span class="n">current_dict</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">data</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

    <span class="nf">write_file</span><span class="p">(</span><span class="n">CONVERT_FILE</span><span class="p">,</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="frontend"><strong>Frontend</strong></h4>

<p>The UI is a React single-page application styled with Bootstrap 5. Bootstrapâ€™s grid and utility classes give us responsive layouts with minimal custom CSS, while React components handle data exchange with the backend through REST calls and display consistent loading, error, and success states.</p>

<p>We enhanced the interface with an AI assistant: the React client calls the ChatGPT API so users can generate a UBL-compliant invoice skeleton from plain-language prompts and request on-the-fly edits to their XML before submission.</p>

<p>We supplied the AI with a fixed system prompt that spells out the UBL schema, and formatting rules, so every response either produces a valid invoice skeleton or returns a well-formed XML patch the user can merge directly.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">const</span> <span class="nx">systemMessage</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">role</span><span class="p">:</span> <span class="dl">"</span><span class="s2">system</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Only help the user to create the UBL XML, you should by default create invoice unless the client wants you to create other.</span><span class="se">\</span><span class="s2">
                    When generating UBL XML put ``` around the code, we will use ``` as sperator and turn the string inside ``` to a file for rendering</span><span class="se">\</span><span class="s2">
                    Make sure the UBL type is invoice </span><span class="se">\</span><span class="s2">
                    it should follow this format: </span><span class="se">\</span><span class="s2">
                    &lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2">?&gt; </span><span class="se">\</span><span class="s2">
                    &lt;Invoice xmlns:cac=</span><span class="se">\"</span><span class="s2">urn:oasis:names:specification:ubl:schema:xsd:CommonAggregateComponents-2</span><span class="se">\"</span><span class="s2"> xmlns:cbc=</span><span class="se">\"</span><span class="s2">urn:oasis:names:specification:ubl:schema:xsd:CommonBasicComponents-2</span><span class="se">\"</span><span class="s2"> xmlns=</span><span class="se">\"</span><span class="s2">urn:oasis:names:specification:ubl:schema:xsd:Invoice-2</span><span class="se">\"</span><span class="s2">&gt; </span><span class="se">\</span><span class="s2">
                    &lt;/Invoice&gt; </span><span class="se">\</span><span class="s2">
                    </span><span class="dl">"</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>Call the OpenAI API for completions.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        <span class="k">await</span> <span class="nf">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://api.openai.com/v1/chat/completions</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
                <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Bearer </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">API_KEY</span><span class="p">,</span>
                <span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span>
            <span class="p">},</span>
            <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">(</span><span class="nx">requestBody</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nf">then</span><span class="p">((</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nf">json</span><span class="p">()</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nf">then</span><span class="p">((</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">message</span><span class="p">.</span><span class="nx">content</span><span class="p">)</span>
            <span class="nf">setMessages</span><span class="p">(</span>
                <span class="p">[...</span><span class="nx">chatMessages</span><span class="p">,</span> <span class="p">{</span>
                    <span class="na">message</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">message</span><span class="p">.</span><span class="nx">content</span><span class="p">,</span>
                    <span class="na">sender</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ChatGPT</span><span class="dl">"</span>
                <span class="p">}]</span>
            <span class="p">);</span>
            <span class="nf">getXML</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">message</span><span class="p">.</span><span class="nx">content</span><span class="p">);</span>
            <span class="nf">setTyping</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
        <span class="p">})</span>
    <span class="p">}</span>
</code></pre></div></div>

<h3 id="deployment">Deployment</h3>

<table>
  <thead>
    <tr>
      <th>Layer</th>
      <th>Platform</th>
      <th>Duty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Backend</td>
      <td>AWS Elastic Beanstalk</td>
      <td>Flask REST APIs, including authentication and token management</td>
    </tr>
    <tr>
      <td>Frontend</td>
      <td>AWS Amplify</td>
      <td>React single-page app</td>
    </tr>
  </tbody>
</table>


  </div><a class="u-url" href="/project/e-invoicing" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Zzn021.github.io</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Zeneng Zhao</li><li><a class="u-email" href="mailto:harry020102@gmail.com">harry020102@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list">
  <!-- Not using --><!--  -->
  	
	<!-- github --><li>
			<a href="https://github.com/Zzn021">
				<svg class="svg-icon">
					<use xlink:href="/assets/minima-social-icons.svg#github"></use>
				</svg>
				<span class="username">Zzn021</span>
			</a>
		</li><!-- Instagram -->
  	<!--<li>
			<a href="https://instagram.com/zenengz_0214">
				<svg class="svg-icon">
					<use xlink:href="/assets/minima-social-icons.svg#instagram"></use>
				</svg>
				<span class="username">zenengz_0214</span>
			</a>
		</li>-->
	<!-- Linkedin --><li>
			<a href="https://www.linkedin.com/in/zeneng-zhao-5129a3223">
				<svg class="svg-icon">
					<use xlink:href="/assets/minima-social-icons.svg#linkedin"></use>
				</svg>
				<span class="username">Zeneng Zhao</span>
			</a>
		</li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Welcome to my personal website, where you can learn more about me :)</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
